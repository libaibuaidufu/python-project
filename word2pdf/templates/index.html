<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pdf、office互转</title>
    <link rel="stylesheet" href="./static/upload.css">
</head>

<body>
<div id="fullscreen">
    <div id="nav">
        PDF、office互转
    </div>
    <div id="container">
        <div id="noscrollbar">

            <div id="upload-area">
                <div id="upload-box">
                    <div class="upload-icon">
                        <svg class="icon" viewBox="0 0 1024 1024" width="80" height="80" version="1.1"
                             xmlns="http://www.w3.org/2000/svg">
                            <path fill="#eee"
                                  d="M796.2 466.4c0-2.4 0.4-4.8 0.4-7.2 0-130-103.6-235.2-231.4-235.2-92.2 0-171.4 54.8-208.6 134-16.2-8.2-34.4-13-53.6-13-59 0-108.2 43.8-117.6 101C114.6 470.4 64 538.2 64 618c0 100.4 80.2 182 179 182L448 800l0-160-96.4 0 160.4-167.4 160.4 167.2-96.4 0 0 160 220.6 0c90.4 0 163.4-75 163.4-166.8C960 541.2 886.6 466.6 796.2 466.4z">
                            </path>
                        </svg>
                        <br>
                        <span class="upload-tips" id="upload_file">点击此处上传</span>
                    </div>
                </div>
                <div class="allow-upload-tips">

                    <!-- <div class="checkboxGroup">
                    <span>请选择压缩质量</span>
                    <div class="checkbox" value="prepress">高质量(300 dpi)</div>
                    <div class="checkbox active" value="ebook">中等质量(150 dpi)</div>
                    <div class="checkbox" value="screen">低质量(72dpi)</div>
                </div> -->
                </div>
            </div>
            <div id="upload-files">


            </div>
        </div>
    </div>
    <div id="foot">
        <div class="foot-part foot-left" id="legalStatement">

        </div>
        <div class="foot-part  foot-center">
            <span id="icp" style="display: none;"></span>
            Power By <a href="https://www.zhengzihui.com" target="_blank">政资汇</a>
        </div>
        <div class="foot-part  foot-right">

        </div>
    </div>
</div>
<script src="./static/jquery-3.6.0.min.js"></script>
<script>
        let uploadArea = document.getElementById("upload-box")

        window.onload = function () {
            addUploadEventListener()
        }
        function addUploadEventListener() {
            uploadArea.addEventListener("click", () => {
                let fileInput = document.createElement("input");
                fileInput.setAttribute("type", "file");
                fileInput.setAttribute("style", "visibility:hidden");
                fileInput.setAttribute("multiple", "multiple");
                // fileInput.setAttribute("accept", "application/pdf")
                fileInput.addEventListener("change", function () {
                    for (let i = 0; i < this.files.length && i < 10; i++) {
                        submit_form(this.files[i]);
                    }
                });
                fileInput.click();
            });
        }









</script>
<script>
        var pdfHtml = `  <div class="upload-file-thumb">
                            <svg style="margin-top:10px" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                width="100" height="100">
                                <path
                                    d="M136.533604 0.00026a49.119975 49.119975 0 0 0-35.839982 15.359992C91.307627 25.600247 85.33463 38.40024 85.33463 51.200234v921.599532a49.119975 49.119975 0 0 0 15.359992 35.839982 50.545974 50.545974 0 0 0 35.839982 15.359992h750.931619a49.119975 49.119975 0 0 0 35.839981-15.359992 50.546974 50.546974 0 0 0 15.359993-35.839982V290.134113L648.533344 0.00026z"
                                    fill="#FF5562"></path>
                                <path
                                    d="M938.666197 290.133113H699.733318a52.492973 52.492973 0 0 1-51.199974-51.199974V0.00026z"
                                    fill="#FFBBC0"></path>
                                <path
                                    d="M730.266302 865.332821c-53.759973 0-101.599948-92.212953-127.146935-151.999923-42.666978-17.919991-89.599955-34.132983-134.826931-45.226977-40.10498 26.560987-107.518945 65.760967-159.624919 65.760966-32.426984 0-55.466972-16.212992-63.999968-44.372977-6.826997-23.039988-0.853-39.25298 5.972997-47.786976q20.47999-28.159986 84.479957-28.159986c34.132983 0 77.652961 5.972997 126.292936 17.919991a762.015613 762.015613 0 0 0 91.306954-75.092962c-12.799994-59.73297-26.452987-156.159921 8.532995-200.532898 17.066991-21.332989 43.519978-28.159986 75.092962-18.77299 34.986982 10.239995 47.786976 31.572984 51.999974 47.786976 14.506993 58.026971-51.999974 136.532931-97.332951 182.666907 10.239995 40.10698 23.039988 81.919958 39.25298 120.319939C695.33332 716.799896 772.080281 759.466874 780.666277 806.399851c3.412998 16.212992-1.706999 31.572984-14.506993 44.372977-11.092994 9.332995-23.039988 14.506993-35.839982 14.506993z m-79.359959-129.706935C683.333326 801.332853 714.000311 831.999838 730.266302 831.999838c2.559999 0 5.972997-0.853 11.092995-5.119998 5.972997-5.972997 5.972997-10.239995 5.119997-13.652993-3.412998-17.066991-30.666984-45.226977-95.572951-77.652961zM335.173503 647.732931c-41.812979 0-53.759973 10.239995-57.172971 14.506993-0.853 1.706999-4.266998 5.972997-0.852999 17.919991 2.559999 10.239995 9.332995 20.47999 31.572984 20.479989 27.306986 0 66.559966-15.359992 112.639942-42.666978-33.332983-6.826997-62.292968-10.239995-86.186956-10.239995z m168.959914-5.119997q41.577979 11.725994 81.919959 27.306986c-9.332995-24.746987-17.066991-50.346974-23.892988-75.092962-18.77299 16.212992-38.399981 32.426984-58.026971 47.786976z m105.866947-275.67986c-9.332995 0-16.212992 3.412998-22.186989 10.239994-17.919991 22.186989-19.62699 78.50696-5.972997 150.186924 51.999974-55.466972 80.212959-106.666946 73.332963-133.972932-0.853-4.266998-4.266998-16.212992-28.159986-23.039988a46.412976 46.412976 0 0 0-17.012991-3.413998z"
                                    fill="#FFFFFF"></path>
                            </svg>
                        </div>
                        `

        var docxHtml = `<div class="upload-file-thumb">
                                <svg  style="margin-top:10px" width="100" height="100" t="1632993352371" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2487" width="200" height="200"><path d="M145.6 0C100.8 0 64 35.2 64 80v862.4C64 987.2 100.8 1024 145.6 1024h732.8c44.8 0 81.6-36.8 81.6-81.6V324.8L657.6 0h-512z" fill="#14A9DA" p-id="2488"></path><path d="M960 326.4v16H755.2s-100.8-20.8-99.2-108.8c0 0 4.8 92.8 97.6 92.8H960z" fill="#0F93D0" p-id="2489"></path><path d="M657.6 0v233.6c0 25.6 17.6 92.8 97.6 92.8H960L657.6 0z" fill="#FFFFFF" opacity=".5" p-id="2490"></path><path d="M291.2 862.4h-48c-9.6 0-17.6-8-17.6-17.6v-158.4c0-9.6 8-16 17.6-16h48c60.8 0 99.2 41.6 99.2 96s-38.4 96-99.2 96z m0-171.2h-41.6v148.8h41.6c48 0 75.2-33.6 75.2-73.6 0-41.6-27.2-75.2-75.2-75.2z m232 174.4c-57.6 0-96-43.2-96-99.2s38.4-99.2 96-99.2c56 0 94.4 41.6 94.4 99.2 0 56-38.4 99.2-94.4 99.2z m0-177.6c-43.2 0-70.4 33.6-70.4 78.4 0 44.8 27.2 76.8 70.4 76.8 41.6 0 70.4-32 70.4-76.8S564.8 688 523.2 688z m294.4 6.4c1.6 1.6 3.2 4.8 3.2 8 0 6.4-4.8 11.2-11.2 11.2-3.2 0-6.4-1.6-8-3.2-11.2-14.4-30.4-22.4-48-22.4-41.6 0-73.6 32-73.6 78.4 0 44.8 32 76.8 73.6 76.8 17.6 0 35.2-6.4 48-20.8 1.6-3.2 4.8-4.8 8-4.8 6.4 0 11.2 6.4 11.2 12.8 0 3.2-1.6 4.8-3.2 8-14.4 16-35.2 27.2-64 27.2-56 0-99.2-40-99.2-99.2s43.2-99.2 99.2-99.2c28.8 0 49.6 11.2 64 27.2z" fill="#FFFFFF" p-id="2491"></path></svg>
                        </div>`
        var cardHtml = `

                        <div class="file-links-box" style="display: block;">
                            <a class="download_button" target="_black">点击下载</a>
                            <span class="fileinfo"></span>
                        </div>
                        <div class="upload-error-cover" style="display:none">
                            <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                                xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30">
                                <path fill="red"
                                    d="M512 53.248c129.707008 3.412992 237.739008 48.299008 324.096 134.656S967.339008 382.292992 970.752 512c-3.412992 129.707008-48.299008 237.739008-134.656 324.096S641.707008 967.339008 512 970.752c-129.707008-3.412992-237.739008-48.299008-324.096-134.656S56.660992 641.707008 53.248 512c3.412992-129.707008 48.299008-237.739008 134.656-324.096S382.292992 56.660992 512 53.248z m0 403.456L405.504 350.208c-8.192-8.192-17.579008-12.288-28.16-12.288-10.580992 0-19.796992 3.924992-27.648 11.776-7.851008 7.851008-11.776 17.067008-11.776 27.648 0 10.580992 4.096 19.968 12.288 28.16l106.496 106.496-106.496 106.496c-8.192 8.192-12.288 17.579008-12.288 28.16 0 10.580992 3.924992 19.796992 11.776 27.648 7.851008 7.851008 17.067008 11.776 27.648 11.776 10.580992 0 19.968-4.096 28.16-12.288l106.496-106.496 106.496 106.496c10.923008 10.24 23.552 13.483008 37.888 9.728s23.380992-12.8 27.136-27.136c3.755008-14.336 0.512-26.964992-9.728-37.888L567.296 512l106.496-106.496c8.192-8.192 12.288-17.579008 12.288-28.16 0-10.580992-3.924992-19.796992-11.776-27.648-7.851008-7.851008-17.067008-11.776-27.648-11.776-10.580992 0-19.968 4.096-28.16 12.288L512 456.704z">
                                </path>
                            </svg>
                            <div style="height:8px"></div>
                            <span class="errorReason"></span>
                        </div>
                        <div class="upload-progress">
                        <div class="progress-bar" style="width: 100%; background: rgb(255, 201, 64);"></div>
                    </div>`
        function submit_form(file) {
            let formData = new FormData();
            formData.append("file", file);

            $.ajax({
                url: "/upload_file",
                type: "POST",
                data: formData,
                async: true,
                cashe: false,
                contentType: false,
                processData: false,
                success: function (returndata) {
                    var url = returndata.data['url']
                    var file_name = returndata.data['file_name']
                    var file_type = returndata.data['type']
                    let uploadFileCards = document.getElementById("upload-files")
                    let card = document.createElement("div");
                    card.className = "upload-file-card";
                    if (file_type == 'pdf') {
                        card.innerHTML = pdfHtml + cardHtml;

                    } else {
                        card.innerHTML = docxHtml + cardHtml;
                    }
                    uploadFileCards.prepend(card);
                    let downloadButton = card.getElementsByClassName("download_button")[0]
                    let fileinfo = card.getElementsByClassName("fileinfo")[0]
                    downloadButton.setAttribute("href", url)
                    fileinfo.innerHTML = file_name
                    uploadFileCards.prepend(card);
                },
                error: function (returndata) {
                    alert("上传失败！")
                }
            })
        }



</script>
</body>

</html>